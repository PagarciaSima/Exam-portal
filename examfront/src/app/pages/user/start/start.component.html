<div class="bootstrap-wrapper mt-5" role="main" *ngIf="!isSubmit">
    <div class="container-fluid">
    <div class="row" role="region" aria-label="Quiz instructions and questions">
            <div class="col-md-2">
                <h3 aria-label="Instructions">Instructions</h3>
            </div>
            <div class="col-md-8">
                <ng-container *ngIf="questions.length > 0">
                    <h1 class="text-center d-flex align-items-center justify-content-center" style="gap: 16px;" aria-label="Quiz title">
                        <img src="assets/img/quiz.gif"
                             alt="Quiz avatar"
                             style="width:40px; height:40px; border-radius:50%; margin-right:12px;"
                             aria-label="Quiz avatar">
                        <span aria-label="Quiz title">On going Quiz: {{ questions[0].quiz.title }}</span>
                    </h1>
                    <mat-card *ngFor="let question of questions; let i = index" class="mt-2" role="group" [attr.aria-label]="'Question ' + (i + 1)">
                        <!-- Content -->
                        <mat-card-content>
                            <div class="d-flex align-items-center justify-content-center mb-2" style="gap: 12px;">
                                <img *ngIf="question.image" [src]="question.image" alt="Imagen de la pregunta" style="width:50px; height:50px; object-fit:fill; border-radius:8px;" [attr.aria-label]="'Imagen de la pregunta ' + (i + 1)">
                                <p class="mb-0">
                                    <b>Q {{ currentPage * pageSize + i + 1 }}:</b>
                                    <span [innerHTML]="question.content" class="ms-2" [attr.aria-label]="'Contenido de la pregunta ' + (currentPage * pageSize + i + 1)"></span>
                                </p>
                            </div>
                            <mat-divider class="my-4" role="separator" aria-label="Separador"></mat-divider>

                            <div class="row">
                                <div class="col-md-5 offset-md-2">
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="option{{question.quesId}}" 
                                            [value]="question.option1" id="option1-{{question.quesId}}" 
                                            [(ngModel)]="question.givenAnswer"
                                            (change)="onAnswerChange(question)"
                                            [attr.aria-label]="'Opción 1: ' + question.option1" 
                                            
                                        />
                                        <label class="form-check-label" for="option1-{{question.quesId}}" [attr.aria-label]="'Opción 1: ' + question.option1">
                                            {{ question.option1 }}
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-5 mr-auto">
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="option{{question.quesId}}"
                                            [value]="question.option2" id="option2-{{question.quesId}}" 
                                            [(ngModel)]="question.givenAnswer"
                                            (change)="onAnswerChange(question)"
                                            [attr.aria-label]="'Opción 2: ' + question.option2" 
                                        />
                                        <label class="form-check-label" for="option2-{{question.quesId}}" [attr.aria-label]="'Opción 2: ' + question.option2">
                                            {{ question.option2 }}
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-5 offset-md-2">
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="option{{question.quesId}}"
                                            [value]="question.option3" id="option3-{{question.quesId}}" 
                                            [(ngModel)]="question.givenAnswer" 
                                            (change)="onAnswerChange(question)"
                                            [attr.aria-label]="'Opción 3: ' + question.option3" 
                                        />
                                        <label class="form-check-label" for="option3-{{question.quesId}}" [attr.aria-label]="'Opción 3: ' + question.option3">
                                            {{ question.option3 }}
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-5 mr-auto">
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="option{{question.quesId}}" 
                                            [value]="question.option4" id="option4-{{question.quesId}}" 
                                            [(ngModel)]="question.givenAnswer" 
                                            (change)="onAnswerChange(question)"
                                            [attr.aria-label]="'Opción 4: ' + question.option4" 
                                        />
                                        <label class="form-check-label" for="option4-{{question.quesId}}" [attr.aria-label]="'Opción 4: ' + question.option4">
                                            {{ question.option4 }}
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </mat-card-content>
                    </mat-card>
                </ng-container>
                    
                <div class="row">
                    <!-- QUESTION BUTTONS -->
                    <div class="d-flex justify-content-center mt-4 col-md-4 offset-md-2" *ngIf="questions.length > 0">
                        <button mat-raised-button color="accent" class="me-2" (click)="prevPage()" [disabled]="currentPage === 0" aria-label="Página anterior">
                            {{ 'BACK' | translate }}
                        </button>
                        <span class="align-self-center mx-2" aria-label="Página actual">{{ currentPage + 1 }} / {{ totalPages }}</span>
                        <button mat-raised-button color="accent" (click)="nextPage()" [disabled]="currentPage >= totalPages - 1" aria-label="Página siguiente">
                            {{ 'NEXT' | translate }}
                        </button>
                    </div>
                    <div class="d-flex justify-content-center mt-4 col-md-4 mr-auto" *ngIf="questions.length > 0">
                        <button mat-raised-button color="primary" (click)="submitQuiz()" aria-label="Enviar respuestas del quiz">
                            {{ 'SUBMIT' | translate }}
                        </button>
                    </div>
                </div>
                    
            </div>
            <div class="col-md-2">

            </div>
        </div>
    </div>
</div>

<!-- SHOW RESULT -->
 <div class="bootstrap-wrapper" *ngIf="isSubmit">
    <div class="row w-100" style="height: 100vh;">
        <div class="col-md-6 offset-md-3">
            <mat-card>
                <mat-card-header class="my-3 d-flex justify-content-center">
                    <mat-card-title>
                        <h2>Quiz Result</h2>
                    </mat-card-title>
                </mat-card-header>
                <mat-card-content class="text-center">
                    <h3><b>Marks Obtained: </b>{{ marksGot }}</h3>
                    <h3><b>Correct Answers: </b>{{ correctAnswers }}</h3>
                    <h3><b>Attempted Questions: </b>{{ attempted }}</h3>
                </mat-card-content>
                <mat-card-actions class="d-flex justify-content-center">
                    <button mat-raised-button color="primary" class="mt-3">
                      print results
                    </button>
                </mat-card-actions>
            </mat-card>
        </div>
    </div>
 </div>